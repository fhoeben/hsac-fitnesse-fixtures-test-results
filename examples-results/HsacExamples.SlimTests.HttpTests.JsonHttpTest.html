<html><head><title>HsacExamples.SlimTests.HttpTests.JsonHttpTest</title><meta http-equiv='Content-Type' content='text/html;charset=UTF-8'/><link rel='stylesheet' type='text/css' href='css/fitnesse.css'/><script src='javascript/jquery-1.11.3.min.js' type='text/javascript'></script><script src='javascript/fitnesse.js' type='text/javascript'></script></head><body><header><h2>HsacExamples.SlimTests.HttpTests.JsonHttpTest</h2></header><article><br/>Example usage of making HTTP calls to get results in <a href="http://json.org">JSON</a> notation and using <a href="http://goessner.net/articles/JsonPath/">JsonPath</a> to validate the response's content.<br/><br/>First a simple GET request.<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="3"><span class="pass">json http test</span></td>
	</tr>
	<tr class="slimRowColor8">
		<td><span class="pass">get from</span></td>
		<td colspan="3"><a href="http://echo.jsontest.com/key/value/one/two">http://echo.jsontest.com/key/value/one/two</a></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response</td>
	<td><pre>{
    &quot;one&quot;: &quot;two&quot;,
    &quot;key&quot;: &quot;value&quot;
}</pre></td></tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>$.key</td>
		<td><span class="pass">value</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>$.one</td>
		<td><span class="pass">two</span></td>
	</tr>
</table>
<br/><br/>Then a POST, showing the multiple notations of JsonPath expressions supported (notice that adding the '$.' prefix is not required).<br/><br/><span class="meta">variable defined: BAD_BODY= {{{
json={"key":"value"
}}} </span>
<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="3"><span class="pass">json http test</span></td>
	</tr>
	<tr class="slimRowColor4">
		<td><span class="pass">post</span></td>
		<td><pre>
json={"key":"value"
</pre></td>
		<td>to</td>
		<td><a href="http://validate.jsontest.com/">http://validate.jsontest.com/</a></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response</td>
	<td><pre>{
    &quot;error_info&quot;: &quot;This error came from the org.json reference parser.&quot;,
    &quot;error&quot;: &quot;Expected a ',' or '}' at 15 [character 16 line 1]&quot;,
    &quot;object_or_array&quot;: &quot;object&quot;,
    &quot;validate&quot;: false
}</pre></td></tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>$.validate</td>
		<td><span class="pass">false</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>validate</td>
		<td><span class="pass">false</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>.validate</td>
		<td><span class="pass">false</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>$['validate']</td>
		<td><span class="pass">false</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>['validate']</td>
		<td><span class="pass">false</span></td>
	</tr>
</table>
<br/><br/>Next another POST, showing that expressions resulting in a boolean or integer value are recognized and can be used accordingly by the script table. Furthermore expressions returning more than a single member are supported.<br/><br/><span class="meta">variable defined: GOOD_BODY= {{{
json={"key":"value"}
}}} </span>
<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="5"><span class="pass">json http test</span></td>
	</tr>
	<tr class="slimRowColor4">
		<td><span class="pass">post</span></td>
		<td><pre>
json={"key":"value"}
</pre></td>
		<td>to</td>
		<td colspan="3"><a href="http://validate.jsontest.com/">http://validate.jsontest.com/</a></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="5">response</td>
	<td><pre>{
    &quot;size&quot;: 1,
    &quot;parse_time_nanoseconds&quot;: 20721,
    &quot;object_or_array&quot;: &quot;object&quot;,
    &quot;validate&quot;: true,
    &quot;empty&quot;: false
}</pre></td></tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>validate</td>
		<td colspan="3"><span class="pass">true</span></td>
	</tr>
	<tr class="slimRowColor8">
		<td><span class="pass">ensure</span></td>
		<td>json path</td>
		<td colspan="4">validate</td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>size</td>
		<td colspan="3"><span class="pass">1&gt;0</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path count</td>
		<td>$.*</td>
		<td colspan="3"><span class="pass">5&gt;=5</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td>all json path matches</td>
		<td colspan="4">*</td>
	<td><div><ul><li>1</li><li>20721</li><li>object</li><li>true</li><li>false</li></ul></div></td></tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>element</td>
		<td>4</td>
		<td>of json path</td>
		<td>$.*</td>
		<td><span class="pass">false</span></td>
	</tr>
</table>
<br/><br/>Next another POST, posting of url-enoded values defined in the wiki.<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="3"><span class="pass">json http test</span></td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td>{"key":"value 2"}</td>
		<td>for</td>
		<td>json</td>
	</tr>
	<tr class="slimRowColor1">
		<td><span class="pass">post values to</span></td>
		<td colspan="3"><a href="http://validate.jsontest.com/">http://validate.jsontest.com/</a></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response</td>
	<td><pre>{
    &quot;size&quot;: 1,
    &quot;parse_time_nanoseconds&quot;: 18966,
    &quot;object_or_array&quot;: &quot;object&quot;,
    &quot;validate&quot;: true,
    &quot;empty&quot;: false
}</pre></td></tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>validate</td>
		<td><span class="pass">true</span></td>
	</tr>
</table>
<br/>Next a PUT example<br/><span class="meta">variable defined: PUT_BODY= {{{
json={"id": 1,
    "title": "foo",
    "body": "bar",
    "userId": 1}
}}} </span>
<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="3"><span class="pass">json http test</span></td>
	</tr>
	<tr class="slimRowColor5">
		<td><span class="fail">put</span></td>
		<td><pre>
json={"id": 1,
    "title": "foo",
    "body": "bar",
    "userId": 1}
</pre></td>
		<td>to</td>
		<td><a href="http://jsonplaceholder.typicode.com/posts/1/">http://jsonplaceholder.typicode.com/posts/1/</a></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response</td>
	<td>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
&lt;meta charset="utf-8"&gt;
&lt;title&gt;Application Error&lt;/title&gt;
&lt;style media="screen"&gt;
		  html,body,iframe {
			margin: 0;
			padding: 0;
		  }
		  html,body {
			height: 100%;
			overflow: hidden;
		  }
		  iframe {
			width: 100%;
			height: 100%;
			border: 0;
		  }
		&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;iframe src="//www.herokucdn.com/error-pages/application-error.html"&gt;&lt;/iframe&gt;
&lt;/body&gt;
&lt;/html&gt;</td></tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path</td>
		<td>id</td>
		<td>[<span class="diff">null</span>] <span class="fail">expected [<span class="diff">&gt;0</span>]</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>json path count</td>
		<td>$.*</td>
		<td><span class="fail">0&gt;=2</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td>all json path matches</td>
		<td colspan="2">*</td>
	<td>null</td></tr>
</table>
</article></body></html>