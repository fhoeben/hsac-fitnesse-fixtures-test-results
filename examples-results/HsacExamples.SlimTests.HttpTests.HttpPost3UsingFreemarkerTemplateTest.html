<html><head><title>HsacExamples.SlimTests.HttpTests.HttpPost3UsingFreemarkerTemplateTest</title><meta http-equiv='Content-Type' content='text/html;charset=UTF-8'/><link rel='stylesheet' type='text/css' href='css/fitnesse.css'/><script src='javascript/jquery-1.11.3.min.js' type='text/javascript'></script><script src='javascript/fitnesse.js' type='text/javascript'></script></head><body><header><h2>HsacExamples.SlimTests.HttpTests.HttpPost3UsingFreemarkerTemplateTest</h2></header><article><br/><h2 id="Bodyfromtemplate">Body from template</h2>
<br/>By using a Freemarker template we can have more dynamic body content.<br/><br/><span class="meta">variable defined: ADD_TEMPLATE_NAME=samplePost.ftl.xml</span>
<br/><br/><h3 id="Dontsendasecondargumentelementerror">Don't send a second argument element: error</h3>
<br/>The Freemarker template will not send a arg2 element if no value is supplied (the whole element will be omitted, as can be seen in the request below). The service will not like this.<br/>Omitting the element on a null value could not be done when the body was in the scenario content.<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="3"><span class="pass">xml http test</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td><span class="pass">template</span></td>
		<td colspan="3">samplePost.ftl.xml</td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td><a href="http://tempuri.org/SOAP.Demo.AddInteger">http://tempuri.org/SOAP.Demo.AddInteger</a></td>
		<td>for header</td>
		<td>SOAPAction</td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td>10</td>
		<td>for</td>
		<td>arg1</td>
	</tr>
	<tr class="slimRowColor8">
		<td>note</td>
		<td colspan="3">the following 'post' is prefixed with 'reject' as the fixture will return false when a soap fault is returned</td>
	</tr>
	<tr class="slimRowColor7">
		<td><span class="pass">reject</span></td>
		<td>post template to</td>
		<td colspan="2">http://www.crcind.com/csp/samples/SOAP.Demo.cls</td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>response status</td>
		<td colspan="2"><span class="pass">400</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">request</td>
	<td><pre>&lt;s11:Envelope xmlns:s11=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
    &lt;s11:Body/&gt;
&lt;/s11:Envelope&gt;
</pre></td></tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response</td>
	<td>Bad Request</td></tr>
</table>
<br/><h3 id="Sendasecondargumentelementsuccess">Send a second argument element: success</h3>
<br/>When a second argument value is set the enclosing element is sent by the Freemarker template (as visible in the shown request content below), and the SOAP call will succeed.<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="3"><span class="pass">xml http test</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td><span class="pass">template</span></td>
		<td colspan="3">samplePost.ftl.xml</td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td><a href="http://tempuri.org/SOAP.Demo.AddInteger">http://tempuri.org/SOAP.Demo.AddInteger</a></td>
		<td>for header</td>
		<td>SOAPAction</td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td>10</td>
		<td>for</td>
		<td>arg1</td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td>30</td>
		<td>for</td>
		<td>arg2</td>
	</tr>
	<tr class="slimRowColor5">
		<td><span class="pass">post template to</span></td>
		<td colspan="3">http://www.crcind.com/csp/samples/SOAP.Demo.cls</td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>response status</td>
		<td colspan="2"><span class="pass">200</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">request</td>
	<td><pre>&lt;s11:Envelope xmlns:s11=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
    &lt;s11:Body&gt;
        &lt;ns1:AddInteger xmlns:ns1=&quot;http://tempuri.org&quot;&gt;
            &lt;ns1:Arg1&gt;10&lt;/ns1:Arg1&gt;
            &lt;ns1:Arg2&gt;30&lt;/ns1:Arg2&gt;
        &lt;/ns1:AddInteger&gt;
    &lt;/s11:Body&gt;
&lt;/s11:Envelope&gt;
</pre></td></tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response headers</td>
	<td><table class="hash_table">
	<tr class="hash_row">
		<td class="hash_key">Cache-Control</td>
		<td class="hash_value">no-cache</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Pragma</td>
		<td class="hash_value">no-cache</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Length</td>
		<td class="hash_value">382</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Type</td>
		<td class="hash_value">text/xml; charset=UTF-8</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Expires</td>
		<td class="hash_value">Thu, 29 Oct 1998 17:04:19 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Server</td>
		<td class="hash_value">Microsoft-IIS/7.5</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Set-Cookie</td>
		<td class="hash_value">[CSPSESSIONID-SP-80-UP-csp-samples-=0030000100008t1CQ3odUa0000QOrmAq6BhsCmfa3MmDjHYQ--; path=/csp/samples/;  httpOnly;, CSPWSERVERID=3941b8e9628f85a8752674c9b2d62a24c037a60f; path=/; httpOnly;]</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Powered-By</td>
		<td class="hash_value">ASP.NET</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Date</td>
		<td class="hash_value">Wed, 17 Jul 2019 07:24:13 GMT</td>
	</tr>
</table></td></tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response</td>
	<td><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:s=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;
    &lt;SOAP-ENV:Body&gt;
        &lt;AddIntegerResponse xmlns=&quot;http://tempuri.org&quot;&gt;
            &lt;AddIntegerResult&gt;40&lt;/AddIntegerResult&gt;
        &lt;/AddIntegerResponse&gt;
    &lt;/SOAP-ENV:Body&gt;
&lt;/SOAP-ENV:Envelope&gt;
</pre></td></tr>
	<tr class="slimRowColor5">
		<td>register prefix</td>
		<td>tempuri</td>
		<td>for namespace</td>
		<td><a href="http://tempuri.org">http://tempuri.org</a></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>xPath</td>
		<td>//tempuri:AddIntegerResult/text()</td>
		<td><span class="pass">40</span></td>
	</tr>
</table>
</article></body></html>