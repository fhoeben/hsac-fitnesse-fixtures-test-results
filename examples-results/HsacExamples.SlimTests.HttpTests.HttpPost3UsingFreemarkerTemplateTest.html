<html><head><title>HsacExamples.SlimTests.HttpTests.HttpPost3UsingFreemarkerTemplateTest</title><meta http-equiv='Content-Type' content='text/html;charset=UTF-8'/><link rel='stylesheet' type='text/css' href='css/fitnesse.css'/><script src='javascript/jquery-1.11.3.min.js' type='text/javascript'></script><script src='javascript/fitnesse.js' type='text/javascript'></script></head><body><header><h2>HsacExamples.SlimTests.HttpTests.HttpPost3UsingFreemarkerTemplateTest</h2></header><article><br/><h2 id="Bodyfromtemplate">Body from template</h2>
<br/>By using a Freemarker template we can have more dynamic body content.<br/><br/><span class="meta">variable defined: GLOBAL_WEATHER_URL=http://www.webservicex.com/globalweather.asmx</span>
<br/><span class="meta">variable defined: GLOBAL_WEATHER_TEMPLATE_NAME=samplePost.ftl.xml</span>
<br/><br/><h3 id="DontsendacityNameelementerror">Don't send a cityName element: error</h3>
<br/>The Freemarker template will not send a cityName element if no value is supplied (the whole element will be omitted, as can be seen in the request below). The service will not like this.<br/>Omitting the element on a null value could not be done when the body was in the scenario content.<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="3"><span class="pass">xml http test</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td><span class="pass">template</span></td>
		<td colspan="3">samplePost.ftl.xml</td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td><a href="http://www.webserviceX.NET/GetWeather">http://www.webserviceX.NET/GetWeather</a></td>
		<td>for header</td>
		<td>SOAPAction</td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td>Canada</td>
		<td>for</td>
		<td>countryName</td>
	</tr>
	<tr class="slimRowColor8">
		<td>note</td>
		<td colspan="3">the following 'post' is prefixed with 'reject' as the fixture will return false when a soap fault is returned</td>
	</tr>
	<tr class="slimRowColor7">
		<td><span class="pass">reject</span></td>
		<td>post template to</td>
		<td colspan="2"><a href="http://www.webservicex.com/globalweather.asmx">http://www.webservicex.com/globalweather.asmx</a></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>response status</td>
		<td colspan="2">[<span class="diff">4</span>0<span class="diff">4</span>] <span class="fail">expected [</span><span class="diff">5</span><span class="fail">0</span><span class="diff">0</span><span class="fail">]</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">request</td>
	<td><pre>&lt;s11:Envelope xmlns:s11=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
    &lt;s11:Body&gt;
        &lt;ns1:GetWeather xmlns:ns1=&quot;http://www.webserviceX.NET&quot;&gt;
            &lt;ns1:CountryName&gt;Canada&lt;/ns1:CountryName&gt;
        &lt;/ns1:GetWeather&gt;
    &lt;/s11:Body&gt;
&lt;/s11:Envelope&gt;
</pre></td></tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response</td>
	<td>{"code":"PAGE_NOT_FOUND","message":"Page not found"}
</td></tr>
</table>
<br/><h3 id="SendacityNameelementsuccess">Send a cityName element: success</h3>
<br/>When a cityName value is set the enclosing element is sent by the Freemarker template (as visible in the shown request content below), and the SOAP call will succeed.<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="3"><span class="pass">xml http test</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td><span class="pass">template</span></td>
		<td colspan="3">samplePost.ftl.xml</td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td><a href="http://www.webserviceX.NET/GetWeather">http://www.webserviceX.NET/GetWeather</a></td>
		<td>for header</td>
		<td>SOAPAction</td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td>Canada</td>
		<td>for</td>
		<td>countryName</td>
	</tr>
	<tr class="slimRowColor5">
		<td>set value</td>
		<td>Vancouver International Air-Port, B. C.</td>
		<td>for</td>
		<td>cityName</td>
	</tr>
	<tr class="slimRowColor5">
		<td><span class="fail">post template to</span></td>
		<td colspan="3"><a href="http://www.webservicex.com/globalweather.asmx">http://www.webservicex.com/globalweather.asmx</a></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>response status</td>
		<td colspan="2">[<span class="diff">4</span>0<span class="diff">4</span>] <span class="fail">expected [</span><span class="diff">2</span><span class="fail">0</span><span class="diff">0</span><span class="fail">]</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">request</td>
	<td><pre>&lt;s11:Envelope xmlns:s11=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
    &lt;s11:Body&gt;
        &lt;ns1:GetWeather xmlns:ns1=&quot;http://www.webserviceX.NET&quot;&gt;
            &lt;ns1:CityName&gt;Vancouver International Air-Port, B. C.&lt;/ns1:CityName&gt;
            &lt;ns1:CountryName&gt;Canada&lt;/ns1:CountryName&gt;
        &lt;/ns1:GetWeather&gt;
    &lt;/s11:Body&gt;
&lt;/s11:Envelope&gt;
</pre></td></tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response headers</td>
	<td><table class="hash_table">
	<tr class="hash_row">
		<td class="hash_key">Server</td>
		<td class="hash_value">nginx/1.4.6 (Ubuntu)</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Date</td>
		<td class="hash_value">Thu, 12 Apr 2018 13:16:36 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Type</td>
		<td class="hash_value">application/json; charset=utf-8</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Length</td>
		<td class="hash_value">53</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Connection</td>
		<td class="hash_value">keep-alive</td>
	</tr>
</table></td></tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response</td>
	<td>{"code":"PAGE_NOT_FOUND","message":"Page not found"}
</td></tr>
	<tr class="slimRowColor5">
		<td>register prefix</td>
		<td>wsX</td>
		<td>for namespace</td>
		<td><a href="http://www.webserviceX.NET">http://www.webserviceX.NET</a></td>
	</tr>
	<tr class="exception closed">
		<td class="error">show</td>
		<td class="error">xPath</td>
		<td colspan="2" class="error">//wsX:GetWeatherResult/text()</td>
	</tr><tr class="exception-detail closed-detail"><td colspan="4"><pre>__EXCEPTION__:java.lang.RuntimeException: Server reported client error: 404
	at nl.hsac.fitnesse.fixture.util.HttpResponse.validResponse(HttpResponse.java:32) [file:/home/travis/build/fhoeben/hsac-fitnesse-fixtures/wiki/fixtures/]
	at nl.hsac.fitnesse.fixture.util.XmlHttpResponse.validResponse(XmlHttpResponse.java:24) [file:/home/travis/build/fhoeben/hsac-fitnesse-fixtures/wiki/fixtures/]
	at nl.hsac.fitnesse.fixture.util.XmlHttpResponse.getXPath(XmlHttpResponse.java:52) [file:/home/travis/build/fhoeben/hsac-fitnesse-fixtures/wiki/fixtures/]
	at nl.hsac.fitnesse.fixture.slim.XmlHttpTest.xPath(XmlHttpTest.java:82) [file:/home/travis/build/fhoeben/hsac-fitnesse-fixtures/wiki/fixtures/]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.8.0_151]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) [rt.jar:1.8.0_151]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) [rt.jar:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) [rt.jar:1.8.0_151]
	at fitnesse.slim.fixtureInteraction.DefaultInteraction.methodInvoke(DefaultInteraction.java:221) [fitnesse-20180127.jar:20180127]
	at nl.hsac.fitnesse.fixture.slim.SlimFixture.invoke(SlimFixture.java:54) [file:/home/travis/build/fhoeben/hsac-fitnesse-fixtures/wiki/fixtures/]
	at nl.hsac.fitnesse.fixture.slim.SlimFixture.aroundSlimInvoke(SlimFixture.java:34) [file:/home/travis/build/fhoeben/hsac-fitnesse-fixtures/wiki/fixtures/]
	at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source) [n/a]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) [rt.jar:1.8.0_151]
	at java.lang.reflect.Method.invoke(Method.java:498) [rt.jar:1.8.0_151]
	at fitnesse.slim.fixtureInteraction.DefaultInteraction.methodInvoke(DefaultInteraction.java:221) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.fixtureInteraction.DefaultInteraction.callMethod(DefaultInteraction.java:204) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.fixtureInteraction.DefaultInteraction.invokeMethod(DefaultInteraction.java:188) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.fixtureInteraction.DefaultInteraction.findAndInvoke(DefaultInteraction.java:166) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.MethodExecutor.findAndInvoke(MethodExecutor.java:18) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.FixtureMethodExecutor.execute(FixtureMethodExecutor.java:18) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.StatementExecutor.getMethodExecutionResult(StatementExecutor.java:139) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.StatementExecutor.call(StatementExecutor.java:112) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.instructions.CallInstruction.executeInternal(CallInstruction.java:35) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.instructions.Instruction.execute(Instruction.java:29) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.ListExecutor$Executive.executeStatement(ListExecutor.java:49) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.ListExecutor$Executive.executeStatements(ListExecutor.java:43) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.ListExecutor.execute(ListExecutor.java:85) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.SlimServer.executeInstructions(SlimServer.java:82) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.SlimServer.processOneSetOfInstructions(SlimServer.java:75) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.SlimServer.tryProcessInstructions(SlimServer.java:62) [fitnesse-20180127.jar:20180127]
	at fitnesse.slim.SlimServer.serve(SlimServer.java:47) [fitnesse-20180127.jar:20180127]
	at fitnesse.testsystems.slim.InProcessSlimClient$1.run(InProcessSlimClient.java:55) [fitnesse-20180127.jar:20180127]
	at java.lang.Thread.run(Thread.java:748) [rt.jar:1.8.0_151]</pre></td></tr>
</table>
</article></body></html>