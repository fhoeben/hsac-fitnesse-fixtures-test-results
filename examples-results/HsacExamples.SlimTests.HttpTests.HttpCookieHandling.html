<html><head><title>HsacExamples.SlimTests.HttpTests.HttpCookieHandling</title><meta http-equiv='Content-Type' content='text/html;charset=UTF-8'/><link rel='stylesheet' type='text/css' href='css/fitnesse.css'/><script src='javascript/jquery-1.11.3.min.js' type='text/javascript'></script><script src='javascript/fitnesse.js' type='text/javascript'></script></head><body><header><h2>HsacExamples.SlimTests.HttpTests.HttpCookieHandling</h2></header><article><br/>By default http test ignores 'Set-Cookie' headers (i.e. cookies received are not sent with subsequent requests). <br/><br/><span class="meta">variable defined: URL_THAT_SENDS_COOKIES=https://mail.live.com/default.aspx</span>
<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="3"><span class="pass">http test</span></td>
	</tr>
	<tr class="slimRowColor8">
		<td><span class="pass">get from</span></td>
		<td colspan="3"><a href="https://mail.live.com/default.aspx">https://mail.live.com/default.aspx</a></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>response status</td>
		<td colspan="2"><span class="pass">200</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response headers</td>
	<td><table class="hash_table">
	<tr class="hash_row">
		<td class="hash_key">Cache-Control</td>
		<td class="hash_value">max-age=0</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Length</td>
		<td class="hash_value">15759</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Type</td>
		<td class="hash_value">text/html; charset=utf-8</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Expires</td>
		<td class="hash_value">Tue, 23 May 2017 15:06:49 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Server</td>
		<td class="hash_value">Microsoft-IIS/8.5</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">P3P</td>
		<td class="hash_value">CP="DSP CUR OTPi IND OTRi ONL FIN"</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Set-Cookie</td>
		<td class="hash_value">[uaid=20869993dceb47a39f2eb69df78bd458; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1, MSPRequ=lt=1495552069&amp;co=1&amp;id=64855; secure= ;path=/;HTTPOnly=;version=1, MSPOK=$uuid-0ee4150c-1d4b-4aa3-9cec-d10891c77e39; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1]</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Frame-Options</td>
		<td class="hash_value">deny</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Content-Type-Options</td>
		<td class="hash_value">nosniff</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Strict-Transport-Security</td>
		<td class="hash_value">max-age=31536000</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-XSS-Protection</td>
		<td class="hash_value">1; mode=block</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Date</td>
		<td class="hash_value">Tue, 23 May 2017 15:07:49 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Connection</td>
		<td class="hash_value">close</td>
	</tr>
</table></td></tr>
	<tr class="slimRowColor8">
		<td>note</td>
		<td colspan="3">By default cookies are not stored</td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>cookie value</td>
		<td>uaid</td>
		<td><span class="pass">null</span></td>
	</tr>
	<tr class="slimRowColor1">
		<td>$setCookie&lt;-[[uaid=20869993dceb47a39f2eb69df78bd458; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1, MSPRequ=lt=1495552069&amp;co=1&amp;id=64855; secure= ;path=/;HTTPOnly=;version=1, MSPOK=$uuid-0ee4150c-1d4b-4aa3-9cec-d10891c77e39; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1]]</td>
		<td>response header</td>
		<td colspan="2">Set-Cookie</td>
	</tr>
</table>
<br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="4"><span class="pass">list fixture</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>size of</td>
		<td>$setCookie->[[uaid=20869993dceb47a39f2eb69df78bd458; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1, MSPRequ=lt=1495552069&co=1&id=64855; secure= ;path=/;HTTPOnly=;version=1, MSPOK=$uuid-0ee4150c-1d4b-4aa3-9cec-d10891c77e39; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1]]</td>
		<td colspan="2"><span class="pass">3&gt;1</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td>value at</td>
		<td>2</td>
		<td>in</td>
		<td>$setCookie->[[uaid=20869993dceb47a39f2eb69df78bd458; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1, MSPRequ=lt=1495552069&co=1&id=64855; secure= ;path=/;HTTPOnly=;version=1, MSPOK=$uuid-0ee4150c-1d4b-4aa3-9cec-d10891c77e39; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1]]</td>
	<td>MSPOK=$uuid-0ee4150c-1d4b-4aa3-9cec-d10891c77e39; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1</td></tr>
</table>
<br/>By setting 'store cookies' to 'true' we can ensure cookies are stored, and sent with subsequent requests.<br/><br/><table>
	<tr class="slimRowTitle">
		<td>script</td>
		<td colspan="5"><span class="pass">http test</span></td>
	</tr>
	<tr class="slimRowColor2">
		<td>set store cookies</td>
		<td colspan="5">true</td>
	</tr>
	<tr class="slimRowColor8">
		<td><span class="pass">get from</span></td>
		<td colspan="5"><a href="https://mail.live.com/default.aspx">https://mail.live.com/default.aspx</a></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>response status</td>
		<td colspan="4"><span class="pass">200</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="5">response headers</td>
	<td><table class="hash_table">
	<tr class="hash_row">
		<td class="hash_key">Cache-Control</td>
		<td class="hash_value">max-age=0</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Length</td>
		<td class="hash_value">15773</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Type</td>
		<td class="hash_value">text/html; charset=utf-8</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Expires</td>
		<td class="hash_value">Tue, 23 May 2017 15:06:50 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Server</td>
		<td class="hash_value">Microsoft-IIS/8.5</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">P3P</td>
		<td class="hash_value">CP="DSP CUR OTPi IND OTRi ONL FIN"</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Set-Cookie</td>
		<td class="hash_value">[uaid=54e8f9c28c3e4f21b6c8e5831a82adc5; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1, MSPRequ=lt=1495552070&amp;co=1&amp;id=64855; secure= ;path=/;HTTPOnly=;version=1, MSPOK=$uuid-4b14ff24-d694-47ae-9398-586ebc4aba4e; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1]</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Frame-Options</td>
		<td class="hash_value">deny</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Content-Type-Options</td>
		<td class="hash_value">nosniff</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Strict-Transport-Security</td>
		<td class="hash_value">max-age=31536000</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-XSS-Protection</td>
		<td class="hash_value">1; mode=block</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Date</td>
		<td class="hash_value">Tue, 23 May 2017 15:07:49 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Connection</td>
		<td class="hash_value">close</td>
	</tr>
</table></td></tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="5">cookie values</td>
	<td><table class="hash_table">
	<tr class="hash_row">
		<td class="hash_key">MSPOK</td>
		<td class="hash_value">$uuid-4b14ff24-d694-47ae-9398-586ebc4aba4e</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">MSPRequ</td>
		<td class="hash_value">lt=1495552070&amp;co=1&amp;id=64855</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">uaid</td>
		<td class="hash_value">54e8f9c28c3e4f21b6c8e5831a82adc5</td>
	</tr>
</table></td></tr>
	<tr class="slimRowColor9">
		<td>check not</td>
		<td>cookie value</td>
		<td>uaid</td>
		<td colspan="3"><span class="pass">null</span></td>
	</tr>
	<tr class="slimRowColor8">
		<td><span class="pass">get from</span></td>
		<td colspan="5"><a href="https://mail.live.com/default.aspx">https://mail.live.com/default.aspx</a></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>response status</td>
		<td colspan="4"><span class="pass">200</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="5">response headers</td>
	<td><table class="hash_table">
	<tr class="hash_row">
		<td class="hash_key">Cache-Control</td>
		<td class="hash_value">max-age=0</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Length</td>
		<td class="hash_value">15758</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Type</td>
		<td class="hash_value">text/html; charset=utf-8</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Expires</td>
		<td class="hash_value">Tue, 23 May 2017 15:06:50 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Server</td>
		<td class="hash_value">Microsoft-IIS/8.5</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">P3P</td>
		<td class="hash_value">CP="DSP CUR OTPi IND OTRi ONL FIN"</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Set-Cookie</td>
		<td class="hash_value">[uaid=54e8f9c28c3e4f21b6c8e5831a82adc5; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1, MSPRequ=lt=1495552070&amp;id=64855&amp;co=2; secure= ;path=/;HTTPOnly=;version=1, MSPOK=$uuid-4b14ff24-d694-47ae-9398-586ebc4aba4e$uuid-0fb1a10d-2b7c-4235-b5c9-9355e89da1e5; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1]</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Frame-Options</td>
		<td class="hash_value">deny</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Content-Type-Options</td>
		<td class="hash_value">nosniff</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Strict-Transport-Security</td>
		<td class="hash_value">max-age=31536000</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-XSS-Protection</td>
		<td class="hash_value">1; mode=block</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Date</td>
		<td class="hash_value">Tue, 23 May 2017 15:07:49 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Connection</td>
		<td class="hash_value">close</td>
	</tr>
</table></td></tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="5">cookie values</td>
	<td><table class="hash_table">
	<tr class="hash_row">
		<td class="hash_key">MSPOK</td>
		<td class="hash_value">$uuid-4b14ff24-d694-47ae-9398-586ebc4aba4e$uuid-0fb1a10d-2b7c-4235-b5c9-9355e89da1e5</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">MSPRequ</td>
		<td class="hash_value">lt=1495552070&amp;id=64855&amp;co=2</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">uaid</td>
		<td class="hash_value">54e8f9c28c3e4f21b6c8e5831a82adc5</td>
	</tr>
</table></td></tr>
	<tr class="slimRowColor9">
		<td>check not</td>
		<td>cookie value</td>
		<td>uaid</td>
		<td colspan="3"><span class="pass">null</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td colspan="6">clear cookies</td>
	</tr>
	<tr class="slimRowColor8">
		<td><span class="pass">get from</span></td>
		<td colspan="5"><a href="https://mail.live.com/default.aspx">https://mail.live.com/default.aspx</a></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>response status</td>
		<td colspan="4"><span class="pass">200</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="5">response headers</td>
	<td><table class="hash_table">
	<tr class="hash_row">
		<td class="hash_key">Cache-Control</td>
		<td class="hash_value">max-age=0</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Length</td>
		<td class="hash_value">15831</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Type</td>
		<td class="hash_value">text/html; charset=utf-8</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Expires</td>
		<td class="hash_value">Tue, 23 May 2017 15:06:50 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Server</td>
		<td class="hash_value">Microsoft-IIS/8.5</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">P3P</td>
		<td class="hash_value">CP="DSP CUR OTPi IND OTRi ONL FIN"</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Set-Cookie</td>
		<td class="hash_value">[uaid=8715cd63bb3847629da29341a6c0c61c; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1, MSPRequ=lt=1495552070&amp;co=1&amp;id=64855; secure= ;path=/;HTTPOnly=;version=1, MSPOK=$uuid-b45bdc21-b5e0-4ac0-8d02-97752f482a62; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1]</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Frame-Options</td>
		<td class="hash_value">deny</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Content-Type-Options</td>
		<td class="hash_value">nosniff</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Strict-Transport-Security</td>
		<td class="hash_value">max-age=31536000</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-XSS-Protection</td>
		<td class="hash_value">1; mode=block</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Date</td>
		<td class="hash_value">Tue, 23 May 2017 15:07:49 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Connection</td>
		<td class="hash_value">close</td>
	</tr>
</table></td></tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="5">cookie values</td>
	<td><table class="hash_table">
	<tr class="hash_row">
		<td class="hash_key">MSPOK</td>
		<td class="hash_value">$uuid-b45bdc21-b5e0-4ac0-8d02-97752f482a62</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">MSPRequ</td>
		<td class="hash_value">lt=1495552070&amp;co=1&amp;id=64855</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">uaid</td>
		<td class="hash_value">8715cd63bb3847629da29341a6c0c61c</td>
	</tr>
</table></td></tr>
	<tr class="slimRowColor9">
		<td>check not</td>
		<td>cookie</td>
		<td>uaid</td>
		<td>value</td>
		<td colspan="2"><span class="pass">null</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>cookie</td>
		<td>uaid</td>
		<td>domain</td>
		<td colspan="2"><span class="pass">login.live.com</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>cookie</td>
		<td>uaid</td>
		<td>path</td>
		<td colspan="2"><span class="pass">/</span></td>
	</tr>
	<tr class="slimRowColor7">
		<td><span class="pass">reject</span></td>
		<td>cookie</td>
		<td>uaid</td>
		<td colspan="3">is persistent</td>
	</tr>
	<tr class="slimRowColor8">
		<td><span class="pass">ensure</span></td>
		<td>cookie</td>
		<td>uaid</td>
		<td colspan="3">is secure</td>
	</tr>
	<tr class="slimRowColor8">
		<td><span class="pass">ensure</span></td>
		<td>cookie</td>
		<td>uaid</td>
		<td colspan="3">is http only</td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>cookie</td>
		<td>uaid</td>
		<td>attribute</td>
		<td>HTTPOnly</td>
		<td><span class="pass">BLANK</span></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>cookie</td>
		<td>uaid</td>
		<td>attribute</td>
		<td>doesNotExist</td>
		<td><span class="pass">null</span></td>
	</tr>
</table>
<br/>If we set 'store cookies' to 'false' cookies are no longer stored.<br/><br/><table>
	<tr class="slimRowTitle">
		<td colspan="4">script</td>
	</tr>
	<tr class="slimRowColor2">
		<td>set store cookies</td>
		<td colspan="3">false</td>
	</tr>
	<tr class="slimRowColor8">
		<td><span class="pass">get from</span></td>
		<td colspan="3"><a href="https://mail.live.com/default.aspx">https://mail.live.com/default.aspx</a></td>
	</tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>response status</td>
		<td colspan="2"><span class="pass">200</span></td>
	</tr>
	<tr class="slimRowColor9">
		<td>show</td>
		<td colspan="3">response headers</td>
	<td><table class="hash_table">
	<tr class="hash_row">
		<td class="hash_key">Cache-Control</td>
		<td class="hash_value">max-age=0</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Length</td>
		<td class="hash_value">15782</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Content-Type</td>
		<td class="hash_value">text/html; charset=utf-8</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Expires</td>
		<td class="hash_value">Tue, 23 May 2017 15:06:50 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Server</td>
		<td class="hash_value">Microsoft-IIS/8.5</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">P3P</td>
		<td class="hash_value">CP="DSP CUR OTPi IND OTRi ONL FIN"</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Set-Cookie</td>
		<td class="hash_value">[uaid=20869993dceb47a39f2eb69df78bd458; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1, MSPRequ=lt=1495552070&amp;id=64855&amp;co=2; secure= ;path=/;HTTPOnly=;version=1, MSPOK=$uuid-0ee4150c-1d4b-4aa3-9cec-d10891c77e39$uuid-89eb7c16-b26c-46b6-8a79-f34baa36a298; domain=login.live.com;secure= ;path=/;HTTPOnly= ;version=1]</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Frame-Options</td>
		<td class="hash_value">deny</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-Content-Type-Options</td>
		<td class="hash_value">nosniff</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Strict-Transport-Security</td>
		<td class="hash_value">max-age=31536000</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">X-XSS-Protection</td>
		<td class="hash_value">1; mode=block</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Date</td>
		<td class="hash_value">Tue, 23 May 2017 15:07:49 GMT</td>
	</tr>
	<tr class="hash_row">
		<td class="hash_key">Connection</td>
		<td class="hash_value">close</td>
	</tr>
</table></td></tr>
	<tr class="slimRowColor0">
		<td>check</td>
		<td>cookie value</td>
		<td>uaid</td>
		<td><span class="pass">null</span></td>
	</tr>
</table>
<br/></article></body></html>